"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7207],{7015:(y,b,c)=>{c.d(b,{_D:()=>E,n:()=>P,p:()=>T,A_:()=>C});var u=c(5861),d=c(1497),t=c(9212),x=c(6369),e=c(878),v=c(95);let F=(()=>{var g;class p{constructor(r,i){this.firestore=r,this.modalController=i,this.fichePatient={nom:"",prenom:"",age:null,adresse:"",telephone:""}}ngOnInit(){this.fichePatient.nom=P,this.fichePatient.prenom=T,console.log("prenom",T,"nom",P)}closeModal(){this.modalController.dismiss()}saveFichePatient(){var r=this;return(0,u.Z)(function*(){try{console.log("Donn\xe9es de la fiche patient \xe0 sauvegarder :",r.fichePatient),r.modalController.dismiss({data:r.fichePatient})}catch(i){console.error("Erreur lors de l'ajout du patient chez le m\xe9decin :",i)}})()}}return(g=p).\u0275fac=function(r){return new(r||g)(t.Y36(x.ST),t.Y36(e.IN))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-fiche-patient-modal"]],inputs:{rendezVousData:"rendezVousData"},decls:35,vars:7,consts:[["slot","end"],[3,"click"],["disabled","",3,"ngModel","ngModelChange"],["type","number",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["type","tel",3,"ngModel","ngModelChange"],["expand","block",3,"click"]],template:function(r,i){1&r&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"Fiche Patient"),t.qZA(),t.TgZ(4,"ion-buttons",0)(5,"ion-button",1),t.NdJ("click",function(){return i.closeModal()}),t._uU(6,"Fermer"),t.qZA()()()(),t.TgZ(7,"ion-content")(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),t._uU(11),t.qZA()(),t.TgZ(12,"ion-card-content")(13,"ion-item")(14,"ion-label"),t._uU(15,"Nom"),t.qZA(),t.TgZ(16,"ion-input",2),t.NdJ("ngModelChange",function(o){return i.rendezVousData.nom=o}),t.qZA()(),t.TgZ(17,"ion-item")(18,"ion-label"),t._uU(19,"Pr\xe9nom"),t.qZA(),t.TgZ(20,"ion-input",2),t.NdJ("ngModelChange",function(o){return i.rendezVousData.prenom=o}),t.qZA()(),t.TgZ(21,"ion-item")(22,"ion-label"),t._uU(23,"\xc2ge"),t.qZA(),t.TgZ(24,"ion-input",3),t.NdJ("ngModelChange",function(o){return i.fichePatient.age=o}),t.qZA()(),t.TgZ(25,"ion-item")(26,"ion-label"),t._uU(27,"Adresse"),t.qZA(),t.TgZ(28,"ion-input",4),t.NdJ("ngModelChange",function(o){return i.fichePatient.adresse=o}),t.qZA()(),t.TgZ(29,"ion-item")(30,"ion-label"),t._uU(31,"T\xe9l\xe9phone"),t.qZA(),t.TgZ(32,"ion-input",5),t.NdJ("ngModelChange",function(o){return i.fichePatient.telephone=o}),t.qZA()(),t.TgZ(33,"ion-button",6),t.NdJ("click",function(){return i.saveFichePatient()}),t._uU(34,"Enregistrer"),t.qZA()()()()),2&r&&(t.xp6(11),t.AsE("",i.rendezVousData.nom," ",i.rendezVousData.prenom,""),t.xp6(5),t.Q6J("ngModel",i.rendezVousData.nom),t.xp6(4),t.Q6J("ngModel",i.rendezVousData.prenom),t.xp6(4),t.Q6J("ngModel",i.fichePatient.age),t.xp6(4),t.Q6J("ngModel",i.fichePatient.adresse),t.xp6(4),t.Q6J("ngModel",i.fichePatient.telephone))},dependencies:[v.JJ,v.On,e.YG,e.Sm,e.PM,e.FN,e.Zi,e.Dq,e.W2,e.Gu,e.pK,e.Ie,e.Q$,e.wd,e.sr,e.as,e.j9]}),p})();var M=c(2344),U=c(6814);function h(g,p){if(1&g){const l=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-button",3),t.NdJ("click",function(){const n=t.CHM(l).$implicit,o=t.oxw();return t.KtG(o.gotopatientpage(n))}),t._UZ(3,"ion-icon",4),t.qZA()(),t.TgZ(4,"ion-col"),t._uU(5),t.qZA(),t.TgZ(6,"ion-col"),t._uU(7),t.qZA(),t.TgZ(8,"ion-col"),t._uU(9),t.qZA(),t.TgZ(10,"ion-col"),t._uU(11),t.qZA()()}if(2&g){const l=p.$implicit;t.xp6(5),t.Oqu(l.nom),t.xp6(2),t.Oqu(l.prenom),t.xp6(2),t.Oqu(l.age),t.xp6(2),t.Oqu(l.telephone)}}let P,T,C,q,E=(()=>{var g;class p{constructor(r,i,n){this.firestore=r,this.modalController=i,this.router=n,this.patients=[],this.rdvs=[],this.uid=d.Ru.uid,this.nomPatient="",this.prenomPatient="",this.patientUid="",this.med=this.uid,this.n=this.nomPatient,this.p=this.prenomPatient}ngOnInit(){this.getPatients(),console.log(q)}gotopatientpage(r){var i=this;return(0,u.Z)(function*(){q=r,C=r.uid,i.router.navigate(["/patientpage"]),console.log("going to patientpage")})()}getPatients(){var r=this;return(0,u.Z)(function*(){try{r.patients=yield(0,d.m3)(r.firestore,r.uid),r.patients.length>0&&(r.nomPatient=r.patients[0].nom,r.prenomPatient=r.patients[0].prenom),console.log("Patients trouv\xe9s :",r.patients)}catch(i){console.error("Erreur lors de la r\xe9cup\xe9ration des patients :",i)}})()}openFichePatientModal(r){var i=this;return(0,u.Z)(function*(){const n=yield i.modalController.create({component:F,componentProps:{patientData:r,medecinUid:i.uid}});return n.onDidDismiss().then(o=>{o&&o.data&&console.log("Donn\xe9es de la fiche patient \xe0 enregistrer :",o.data)}),yield n.present()})()}showConsultations(r){var i=this;return(0,u.Z)(function*(){C=r,i.router.navigate(["/consultationliste"])})()}search(r){var i=this;return(0,u.Z)(function*(){const n=r.target.value.toLowerCase().trim();n?i.patients=i.patients.filter(o=>o.prenom.toLowerCase().startsWith(n)):i.getPatients()})()}}return(g=p).\u0275fac=function(r){return new(r||g)(t.Y36(x.ST),t.Y36(e.IN),t.Y36(M.F0))},g.\u0275cmp=t.Xpm({type:g,selectors:[["app-affiche-patient"]],decls:30,vars:1,consts:[["routerLink","/app-medecin","fill","clear","slot","start"],["placeholder","Rechercher",3,"ionInput"],[4,"ngFor","ngForOf"],["color","primary",3,"click"],["name","folder-sharp"]],template:function(r,i){1&r&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-button",0),t._uU(3," Retour "),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"Liste des Patients"),t.qZA()()(),t.TgZ(6,"ion-content")(7,"ion-header"),t._UZ(8,"br"),t.TgZ(9,"ion-searchbar",1),t.NdJ("ionInput",function(o){return i.search(o)}),t.qZA(),t._UZ(10,"br"),t.qZA(),t.TgZ(11,"ion-list")(12,"ion-grid")(13,"ion-row")(14,"ion-col")(15,"strong"),t._uU(16,"Option"),t.qZA()(),t.TgZ(17,"ion-col")(18,"strong"),t._uU(19,"Nom"),t.qZA()(),t.TgZ(20,"ion-col")(21,"strong"),t._uU(22,"Pr\xe9nom"),t.qZA()(),t.TgZ(23,"ion-col")(24,"strong"),t._uU(25,"Age"),t.qZA()(),t.TgZ(26,"ion-col")(27,"strong"),t._uU(28,"T\xe9l\xe9phone"),t.qZA()()(),t.YNc(29,h,12,4,"ion-row",2),t.qZA()()()),2&r&&(t.xp6(29),t.Q6J("ngForOf",i.patients))},dependencies:[U.sg,e.YG,e.wI,e.W2,e.jY,e.Gu,e.gu,e.q_,e.Nd,e.VI,e.wd,e.sr,e.j9,e.YI,M.rH]}),p})()},7207:(y,b,c)=>{c.d(b,{i:()=>p,w:()=>g});var u=c(5861),d=c(1497),t=c(7015),x=c(4716),e=c(9212),v=c(778),F=c(6369),s=c(878),M=c(2344),U=c(6814),h=c(95);function E(l,r){if(1&l){const i=e.EpF();e.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title")(3,"b"),e._uU(4,"Fiche Patient"),e.qZA()()(),e.TgZ(5,"ion-card-content")(6,"ion-card")(7,"ion-card-header")(8,"ion-card-title")(9,"b"),e._uU(10,"Info patient"),e.qZA()()(),e.TgZ(11,"ion-card-content")(12,"ion-item")(13,"ion-label"),e._uU(14,"Nom"),e.qZA(),e.TgZ(15,"ion-input",5),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.nom=o)}),e.qZA()(),e.TgZ(16,"ion-item")(17,"ion-label"),e._uU(18,"Pr\xe9nom"),e.qZA(),e.TgZ(19,"ion-input",5),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.prenom=o)}),e.qZA()(),e.TgZ(20,"ion-item")(21,"ion-label"),e._uU(22,"\xc2ge"),e.qZA(),e.TgZ(23,"ion-input",6),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.age=o)}),e.qZA()(),e.TgZ(24,"ion-item")(25,"ion-label"),e._uU(26,"Sexe"),e.qZA(),e.TgZ(27,"ion-select",7),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.sexe=o)}),e.TgZ(28,"ion-select-option",8),e._uU(29,"Femme"),e.qZA(),e.TgZ(30,"ion-select-option",9),e._uU(31,"Homme"),e.qZA()()(),e.TgZ(32,"ion-item")(33,"ion-label"),e._uU(34,"Groupe Sanguin"),e.qZA(),e.TgZ(35,"ion-select",10),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.groupeSanguin=o)}),e.TgZ(36,"ion-select-option",11),e._uU(37,"A+"),e.qZA(),e.TgZ(38,"ion-select-option",12),e._uU(39,"A-"),e.qZA(),e.TgZ(40,"ion-select-option",13),e._uU(41,"B+"),e.qZA(),e.TgZ(42,"ion-select-option",14),e._uU(43,"B-"),e.qZA(),e.TgZ(44,"ion-select-option",15),e._uU(45,"AB+"),e.qZA(),e.TgZ(46,"ion-select-option",16),e._uU(47,"AB-"),e.qZA(),e.TgZ(48,"ion-select-option",17),e._uU(49,"O+"),e.qZA(),e.TgZ(50,"ion-select-option",18),e._uU(51,"O-"),e.qZA()()(),e.TgZ(52,"ion-item")(53,"ion-label"),e._uU(54,"Situation familiale"),e.qZA(),e.TgZ(55,"ion-select",19),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.situationFamiliale=o)}),e.TgZ(56,"ion-select-option",20),e._uU(57,"C\xe9libataire"),e.qZA(),e.TgZ(58,"ion-select-option",21),e._uU(59,"Mari\xe9(e)"),e.qZA(),e.TgZ(60,"ion-select-option",22),e._uU(61,"Divorc\xe9(e)"),e.qZA(),e.TgZ(62,"ion-select-option",23),e._uU(63,"Veuf/Veuve"),e.qZA()()(),e.TgZ(64,"ion-item")(65,"ion-label"),e._uU(66,"Profession"),e.qZA(),e.TgZ(67,"ion-input",24),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.profession=o)}),e.qZA()()()(),e.TgZ(68,"ion-card")(69,"ion-card-header")(70,"ion-card-title")(71,"b"),e._uU(72,"Coordonn\xe9es Patient"),e.qZA()()(),e.TgZ(73,"ion-card-content")(74,"ion-item")(75,"ion-label"),e._uU(76,"Adresse Mail"),e.qZA(),e.TgZ(77,"ion-input",25),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.email=o)}),e.qZA()(),e.TgZ(78,"ion-item")(79,"ion-label"),e._uU(80,"T\xe9l\xe9phone 1"),e.qZA(),e.TgZ(81,"ion-input",26),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.telephone=o)}),e.qZA()(),e.TgZ(82,"ion-item")(83,"ion-label"),e._uU(84,"T\xe9l\xe9phone 2"),e.qZA(),e.TgZ(85,"ion-input",26),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.telephone2=o)}),e.qZA()(),e.TgZ(86,"ion-item")(87,"ion-label"),e._uU(88,"Num\xe9ro Assurance"),e.qZA(),e.TgZ(89,"ion-input",26),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.numeroAssurance=o)}),e.qZA()(),e.TgZ(90,"ion-item")(91,"ion-label"),e._uU(92,"Adresse"),e.qZA(),e.TgZ(93,"ion-input",5),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.adresse=o)}),e.qZA()(),e.TgZ(94,"ion-item")(95,"ion-label",27),e._uU(96,"Note"),e.qZA(),e.TgZ(97,"ion-textarea",28),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.note=o)}),e.qZA()()()(),e.TgZ(98,"ion-card")(99,"ion-card-header")(100,"ion-card-title")(101,"b"),e._uU(102,"Ant\xe9c\xe9dents"),e.qZA()()(),e.TgZ(103,"ion-card-content")(104,"ion-item")(105,"ion-label",27),e._uU(106,"Ant\xe9c\xe9dents M\xe9dicaux"),e.qZA(),e.TgZ(107,"ion-textarea",28),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.antecedentsMedicaux=o)}),e.qZA()(),e.TgZ(108,"ion-item")(109,"ion-label",27),e._uU(110,"Ant\xe9c\xe9dents Chirurgicaux"),e.qZA(),e.TgZ(111,"ion-textarea",28),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.antecedentsChirurgicaux=o)}),e.qZA()(),e.TgZ(112,"ion-item")(113,"ion-label",27),e._uU(114,"Ant\xe9c\xe9dents Familiaux"),e.qZA(),e.TgZ(115,"ion-textarea",28),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.antecedentsFamiliaux=o)}),e.qZA()(),e.TgZ(116,"ion-item")(117,"ion-label",27),e._uU(118,"Autres Ant\xe9c\xe9dents"),e.qZA(),e.TgZ(119,"ion-textarea",28),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.autresAntecedents=o)}),e.qZA()(),e.TgZ(120,"ion-item")(121,"ion-label",27),e._uU(122,"M\xe9dicaments du patient"),e.qZA(),e.TgZ(123,"ion-textarea",28),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.medicaments=o)}),e.qZA()()()(),e.TgZ(124,"ion-button",29),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.saveFichePatient())}),e._uU(125,"Enregistrer"),e.qZA()()()}if(2&l){const i=e.oxw();e.xp6(15),e.Q6J("ngModel",i.nom),e.xp6(4),e.Q6J("ngModel",i.prenom),e.xp6(4),e.Q6J("ngModel",i.age),e.xp6(4),e.Q6J("ngModel",i.sexe),e.xp6(8),e.Q6J("ngModel",i.groupeSanguin),e.xp6(20),e.Q6J("ngModel",i.situationFamiliale),e.xp6(12),e.Q6J("ngModel",i.profession),e.xp6(10),e.Q6J("ngModel",i.email),e.xp6(4),e.Q6J("ngModel",i.telephone),e.xp6(4),e.Q6J("ngModel",i.telephone2),e.xp6(4),e.Q6J("ngModel",i.numeroAssurance),e.xp6(4),e.Q6J("ngModel",i.adresse),e.xp6(4),e.Q6J("ngModel",i.note),e.xp6(10),e.Q6J("ngModel",i.antecedentsMedicaux),e.xp6(4),e.Q6J("ngModel",i.antecedentsChirurgicaux),e.xp6(4),e.Q6J("ngModel",i.antecedentsFamiliaux),e.xp6(4),e.Q6J("ngModel",i.autresAntecedents),e.xp6(4),e.Q6J("ngModel",i.medicaments)}}function J(l,r){if(1&l){const i=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-button",36),e.NdJ("click",function(){const a=e.CHM(i).$implicit,_=e.oxw(2);return e.KtG(_.editConsultation(a))}),e._uU(4,"Modifier"),e.qZA()()}if(2&l){const i=r.$implicit;e.xp6(2),e.Oqu(i.date)}}function P(l,r){if(1&l){const i=e.EpF();e.TgZ(0,"ion-card")(1,"ion-card-content")(2,"ion-card")(3,"form",30,31),e.NdJ("ngSubmit",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.searchConsultations())}),e.TgZ(5,"ion-item")(6,"ion-label"),e._uU(7,"Date de consultation"),e.qZA(),e.TgZ(8,"ion-input",32),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.consultationDate=o)}),e.qZA()(),e.TgZ(9,"div",33)(10,"ion-button",34),e._uU(11,"Rechercher"),e.qZA()()(),e.TgZ(12,"ion-list"),e.YNc(13,J,5,1,"ion-item",35),e.qZA()()()()}if(2&l){const i=e.MAs(4),n=e.oxw();e.xp6(8),e.Q6J("ngModel",n.consultationDate),e.xp6(2),e.Q6J("disabled",!i.valid),e.xp6(3),e.Q6J("ngForOf",n.consultations)}}function T(l,r){if(1&l){const i=e.EpF();e.TgZ(0,"div")(1,"ion-input",41),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw(2);return e.KtG(a.description=o)}),e.qZA(),e.TgZ(2,"ion-button",42),e.NdJ("click",function(){e.CHM(i);const o=e.oxw(2);return e.KtG(o.envoyer())}),e._UZ(3,"ion-icon",43),e._uU(4," \xa0\xa0Envoyer "),e.qZA(),e._UZ(5,"img",44),e.qZA()}if(2&l){const i=e.oxw(2);e.xp6(),e.Q6J("ngModel",i.description),e.xp6(4),e.Q6J("src",i.selectedFile,e.LSH)}}function C(l,r){if(1&l&&(e.TgZ(0,"ion-item"),e._UZ(1,"img",45),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e.TgZ(4,"a",46),e._uU(5," Voir d\xe9tail.."),e.qZA()()),2&l){const i=r.$implicit;e.xp6(),e.Q6J("src",i.url,e.LSH),e.xp6(2),e.Oqu(i.description),e.xp6(),e.Q6J("href",i.url,e.LSH)}}function q(l,r){if(1&l){const i=e.EpF();e.TgZ(0,"ion-card")(1,"ion-card-content")(2,"ion-card-header"),e._UZ(3,"br")(4,"ion-searchbar",37)(5,"br"),e.qZA(),e.TgZ(6,"ion-card",38)(7,"ion-card-content"),e._UZ(8,"br")(9,"br")(10,"br")(11,"br")(12,"br")(13,"br")(14,"br")(15,"br"),e.TgZ(16,"input",39),e.NdJ("change",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.onFileSelected(o))}),e.qZA()()(),e.YNc(17,T,6,2,"div",4),e.TgZ(18,"ion-card")(19,"div")(20,"ion-list")(21,"ion-input",40),e.NdJ("ngModelChange",function(o){e.CHM(i);const a=e.oxw();return e.KtG(a.searchDescription=o)}),e.qZA(),e.TgZ(22,"ion-button",2),e.NdJ("click",function(){e.CHM(i);const o=e.oxw();return e.KtG(o.searchDocumentsByDescription(o.searchDescription))}),e._uU(23,"Rechercher"),e.qZA(),e.YNc(24,C,6,3,"ion-item",35),e._UZ(25,"br")(26,"br"),e.qZA()()()()()}if(2&l){const i=e.oxw();e.xp6(17),e.Q6J("ngIf",i.selectedFile),e.xp6(4),e.Q6J("ngModel",i.searchDescription),e.xp6(3),e.Q6J("ngForOf",i.documents)}}let p,g=(()=>{var l;class r{constructor(n,o,a,_,m,Z){this.storage=n,this.firestore=o,this.toastController=a,this.modalController=_,this.cdr=m,this.router=Z,this.Vfiche=!0,this.Vconsultation=!1,this.Vdocument=!1,this.uid="",this.nom="",this.prenom="",this.age=0,this.adresse="",this.telephone="",this.sexe="",this.groupeSanguin="",this.situationFamiliale="",this.profession="",this.email="",this.telephone2="",this.numeroAssurance="",this.note="",this.antecedentsMedicaux="",this.antecedentsChirurgicaux="",this.antecedentsFamiliaux="",this.autresAntecedents="",this.medicaments="",this.description="",this.selectedFile=null,this.selectedFileUrl=null,this.documents=[],this.consultationDate="",this.searchDescription="",this.rendezVousData={}}ngOnInit(){var n=this;return(0,u.Z)(function*(){const o=yield(0,d.qi)(n.firestore,d.Ru.uid,t.A_);console.log(o),console.log(t.A_),n.getdocument();try{n.patient=yield(0,d.Ud)(n.firestore,d.Ru.uid,t.A_),n.patient&&(n.nom=n.patient.nom,n.prenom=n.patient.prenom,n.sexe=n.patient.sexe,n.groupeSanguin=n.patient.groupeSanguin,n.age=n.patient.age,n.adresse=n.patient.adresse,n.telephone=n.patient.telephone,n.situationFamiliale=n.patient.situationFamiliale,n.profession=n.patient.profession,n.email=n.patient.email,n.telephone2=n.patient.telephone2,n.numeroAssurance=n.patient.numeroAssurance,n.note=n.patient.note,n.antecedentsMedicaux=n.patient.antecedentsMedicaux,n.antecedentsChirurgicaux=n.patient.antecedentsChirurgicaux,n.antecedentsFamiliaux=n.patient.antecedentsFamiliaux,n.autresAntecedents=n.patient.autresAntecedents,n.medicaments=n.patient.medicaments,console.log("patient",n.patient)),yield n.loadConsultations(),console.log("rdv",n.rdv)}catch(a){console.error("Erreur lors de l'initialisation de la page :",a)}})()}back(){var n=this;return(0,u.Z)(function*(){n.router.navigate(["/patient"]),console.log("going to patient")})()}loadConsultations(){var n=this;return(0,u.Z)(function*(){try{const o=yield(0,d.Kc)(n.firestore,d.Ru.uid,t.A_);console.log("consultations",o),o&&o.length>0?n.consultations=o.sort((a,_)=>new Date(_.date).getTime()-new Date(a.date).getTime()):console.log("Aucune consultation trouv\xe9e pour ce patient.")}catch(o){console.error("Erreur lors du chargement des consultations du patient :",o)}})()}saveFichePatient(){var n=this;return(0,u.Z)(function*(){try{console.log("Donn\xe9es de la fiche patient \xe0 sauvegarder :",n.adresse,n.age,n.antecedentsChirurgicaux,n.antecedentsFamiliaux,n.antecedentsMedicaux,n.autresAntecedents,n.email,n.medicaments,n.groupeSanguin,n.nom,n.note,n.numeroAssurance,n.prenom,n.profession,n.sexe,n.situationFamiliale,n.telephone,n.telephone2,n.uid),yield(0,d.co)(n.firestore,n.adresse,n.age,n.antecedentsChirurgicaux,n.antecedentsFamiliaux,n.antecedentsMedicaux,n.autresAntecedents,n.email,n.medicaments,n.groupeSanguin,n.nom,n.note,n.numeroAssurance,n.prenom,n.profession,n.sexe,n.situationFamiliale,n.telephone,n.telephone2,t.A_,d.Ru.uid)}catch(o){console.error("Erreur lors de l'ajout du patient chez le m\xe9decin :",o)}})()}fiche(){this.Vconsultation=!1,this.Vdocument=!1,this.Vfiche=!0}consultation(){this.Vconsultation=!0,this.Vdocument=!1,this.Vfiche=!1}document(){this.Vconsultation=!1,this.Vdocument=!0,this.Vfiche=!1}onFileSelected(n){var o=this;return(0,u.Z)(function*(){const a=n.target.files[0];if(o.selectedFile=a,a instanceof File)try{const m=`documents/${Math.random().toString(36).substring(2)}_${a.name}`,Z=o.storage.ref(m);o.storage.upload(m,a).snapshotChanges().pipe((0,x.x)((0,u.Z)(function*(){const A=yield Z.getDownloadURL().toPromise();console.log("Lien permanent du fichier :",A);const f=o.description;f?(yield o.firestore.collection("medecin").doc(d.Ru.uid).collection("documents").doc().set({medecinUid:d.Ru.uid,patientUid:t.A_,url:A,description:f}),o.getdocument(),console.log("Document ajout\xe9 avec succ\xe8s.")):console.error("La description est obligatoire pour t\xe9l\xe9charger le fichier.")}))).subscribe()}catch(_){console.error("Erreur lors de l'ajout du document :",_)}})()}envoyer(){var n=this;return(0,u.Z)(function*(){if(!n.selectedFile)return void console.error("Aucun fichier s\xe9lectionn\xe9.");if(!n.description)return void(yield(yield n.toastController.create({message:"La description est obligatoire.",duration:1500,position:"top",color:"danger"})).present());const o=n.firestore.createId(),a=`documents/${o}`;try{var _,m;const Z=n.storage.ref(a);yield n.storage.upload(a,n.selectedFile).then();const A=yield Z.getDownloadURL().toPromise();yield n.firestore.collection("documents").doc(o).set({useruid:null===(_=n.patient)||void 0===_?void 0:_.useruid,url:A,description:n.description});const f=yield(0,d.qi)(n.firestore,d.Ru.uid,t.A_);f&&f.length>0&&(n.documents=f),console.log("Fichier t\xe9l\xe9charg\xe9 et enregistr\xe9 avec succ\xe8s.");const D={url:A,description:n.description,med:d.Ru.uid};yield n.firestore.collection("inscrits").doc(null===(m=n.patient)||void 0===m?void 0:m.useruid).collection("document").add(D)}catch(Z){console.error("Erreur lors de l'envoi du fichier :",Z)}})()}getdocument(){var n=this;return(0,u.Z)(function*(){const o=yield(0,d.qi)(n.firestore,d.Ru.uid,t.A_);o&&o.length>0&&(n.documents=o)})()}closeModal(){this.modalController.dismiss()}editConsultation(n){var o=this;return(0,u.Z)(function*(){p=n.date,o.router.navigate(["/consultation-modif"])})()}searchConsultations(){var n=this;return(0,u.Z)(function*(){try{if(!n.consultationDate)return void console.log("Veuillez s\xe9lectionner une date de consultation.");n.consultations=n.consultations.filter(o=>o.date===n.consultationDate),0===n.consultations.length?console.log("Aucune consultation trouv\xe9e pour la date sp\xe9cifi\xe9e."):console.log("Consultations trouv\xe9es pour la date",n.consultationDate,":",n.consultations)}catch(o){console.error("Erreur lors de la recherche des consultations pour la date :",o)}})()}searchDocumentsByDescription(n){var o=this;return(0,u.Z)(function*(){try{if(!n)return void console.log("Veuillez entrer une description.");const a=o.documents.filter(_=>_.description===n);a.length>0?(console.log("Documents trouv\xe9s avec la description",n,":",a),o.documents=a):console.log("Aucun document trouv\xe9 avec la description",n)}catch(a){console.error("Erreur lors de la recherche des documents pour la description :",a)}})()}}return(l=r).\u0275fac=function(n){return new(n||l)(e.Y36(v.Q1),e.Y36(F.ST),e.Y36(s.yF),e.Y36(s.IN),e.Y36(e.sBO),e.Y36(M.F0))},l.\u0275cmp=e.Xpm({type:l,selectors:[["app-patientpage"]],decls:18,vars:5,consts:[["routerLink","/patient","slot","start","fill","clear"],[2,"text-align","center"],[3,"click"],[1,"complet"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["type","number",3,"ngModel","ngModelChange"],["placeholder","Choisissez le sexe",3,"ngModel","ngModelChange"],["value","femme"],["value","homme"],["placeholder","Choisissez le groupe sanguin",3,"ngModel","ngModelChange"],["value","A+"],["value","A-"],["value","B+"],["value","B-"],["value","AB+"],["value","AB-"],["value","O+"],["value","O-"],["placeholder","Choisissez la situation familiale",3,"ngModel","ngModelChange"],["value","C\xe9libataire"],["value","Mari\xe9(e)"],["value","Divorc\xe9(e)"],["value","Veuf/Veuve"],[3,"ngModel","ngModelChange"],["type","email",3,"ngModel","ngModelChange"],["type","tel",3,"ngModel","ngModelChange"],["position","floating"],["rows","6",3,"ngModel","ngModelChange"],["expand","block",3,"click"],[3,"ngSubmit"],["searchForm","ngForm"],["type","date","name","consultationDate","required","",3,"ngModel","ngModelChange"],[1,"middle"],["type","submit",3,"disabled"],[4,"ngFor","ngForOf"],["color","primary",3,"click"],["placeholder","Rechercher"],[1,"upload-document"],["type","file","id","fileInput","name","fileInput","accept","*/*",3,"change"],["type","text","placeholder","entrer une description a rechercher","color","primary",3,"ngModel","ngModelChange"],["type","text","placeholder","Enter document description","required","",3,"ngModel","ngModelChange"],[1,"ion-text-end",3,"click"],["name","send-outline"],["alt","Selected Image",3,"src"],["width","60","height","60",3,"src"],["float","right","target","_blank",3,"href"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header")(1,"ion-button",0),e._uU(2,"retour"),e.qZA(),e.TgZ(3,"ion-toolbar")(4,"ion-title",1),e._uU(5),e.qZA()(),e.TgZ(6,"ion-toolbar")(7,"ion-segment")(8,"ion-segment-button",2),e.NdJ("click",function(){return o.fiche()}),e._uU(9,"Fiche Patient"),e.qZA(),e.TgZ(10,"ion-segment-button",2),e.NdJ("click",function(){return o.consultation()}),e._uU(11,"Consultations"),e.qZA(),e.TgZ(12,"ion-segment-button",2),e.NdJ("click",function(){return o.document()}),e._uU(13,"Documents"),e.qZA()()()(),e.TgZ(14,"ion-content",3),e.YNc(15,E,126,18,"ion-card",4)(16,P,14,3,"ion-card",4)(17,q,27,3,"ion-card",4),e.qZA()),2&n&&(e.xp6(5),e.AsE("info patients : ",null==o.patient?null:o.patient.nom," ",null==o.patient?null:o.patient.prenom,""),e.xp6(10),e.Q6J("ngIf",o.Vfiche),e.xp6(),e.Q6J("ngIf",o.Vconsultation),e.xp6(),e.Q6J("ngIf",o.Vdocument))},dependencies:[U.sg,U.O5,h._Y,h.JJ,h.JL,h.Q7,h.On,h.F,s.YG,s.PM,s.FN,s.Zi,s.Dq,s.W2,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.VI,s.cJ,s.GO,s.t9,s.n0,s.g2,s.wd,s.sr,s.as,s.QI,s.j9,s.YI,M.rH],styles:[".complet[_ngcontent-%COMP%]{width:100%;height:100%}.upload[_ngcontent-%COMP%]{position:sticky;width:90%;height:90%;background-size:cover;display:flex;align-items:center;justify-content:center}.upload-document[_ngcontent-%COMP%]{border:2px dashed #ccc;padding:10px;cursor:pointer;display:inline-block;width:100%;text-align:center;color:#333;background-image:url(upload.258493b034e3e7d7.png);background-size:contain;background-position:center;background-repeat:no-repeat}.upload-document[_ngcontent-%COMP%]:hover{border-color:#aaa}.right[_ngcontent-%COMP%]{float:right}.ion-text-end[_ngcontent-%COMP%]{text-align:end!important;float:right}.image[_ngcontent-%COMP%]{width:40%;height:40%}"]}),r})()}}]);