{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/MacBook Air/Desktop/shifai1VV/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _ConsultationsModalComponent, _ConsultationsModalModule;\nimport { CommonModule } from '@angular/common';\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/firestore\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction ConsultationsModalComponent_ion_item_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-textarea\", 4);\n    i0.ɵɵlistener(\"ngModelChange\", function ConsultationsModalComponent_ion_item_9_Template_ion_textarea_ngModelChange_4_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const consultation_r1 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(consultation_r1.details = $event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const consultation_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Date: \", i0.ɵɵpipeBind1(3, 2, consultation_r1.date), \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", consultation_r1.details);\n  }\n}\nexport class ConsultationsModalComponent {\n  constructor(firestore, modalController) {\n    this.firestore = firestore;\n    this.modalController = modalController;\n    this.newConsultation = {\n      date: new Date(),\n      details: ''\n    };\n    this.consultations = [];\n  }\n  ngOnInit() {\n    // Chargez les consultations existantes du patient ici\n    this.loadConsultations();\n  }\n  loadConsultations() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      try {\n        const consultationsSnapshot = yield _this.firestore.collection('medecin').doc(_this.patientData.medecinuid).collection('patients').doc(_this.patientData.nom).collection('consultations').get().toPromise();\n        if (consultationsSnapshot) {\n          _this.consultations = consultationsSnapshot.docs.map(doc => doc.data());\n        } else {\n          console.log('Aucune consultation trouvée pour ce patient.');\n        }\n      } catch (error) {\n        console.error('Erreur lors du chargement des consultations du patient :', error);\n      }\n    })();\n  }\n  addConsultation() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      try {\n        // Ajoutez la nouvelle consultation à Firestore\n        yield _this2.firestore.collection('medecin').doc(_this2.patientData.medecinuid).collection('patients').doc(_this2.patientData.nom).collection('consultations').add(_this2.newConsultation);\n        // Ajoutez également la nouvelle consultation à la liste locale des consultations\n        _this2.consultations.push({\n          ..._this2.newConsultation\n        });\n        // Réinitialisez les champs de la nouvelle consultation\n        _this2.newConsultation = {\n          date: new Date(),\n          details: ''\n        };\n        console.log('Nouvelle consultation ajoutée avec succès.');\n      } catch (error) {\n        console.error('Erreur lors de l\\'ajout de la nouvelle consultation :', error);\n      }\n    })();\n  }\n  closeModal() {\n    this.modalController.dismiss(); // Fermer le modal\n  }\n}\n_ConsultationsModalComponent = ConsultationsModalComponent;\n_ConsultationsModalComponent.ɵfac = function ConsultationsModalComponent_Factory(t) {\n  return new (t || _ConsultationsModalComponent)(i0.ɵɵdirectiveInject(i1.AngularFirestore), i0.ɵɵdirectiveInject(i2.ModalController));\n};\n_ConsultationsModalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: _ConsultationsModalComponent,\n  selectors: [[\"app-consultations-modal\"]],\n  inputs: {\n    patientData: \"patientData\"\n  },\n  decls: 10,\n  vars: 1,\n  consts: [[\"slot\", \"end\"], [3, \"click\"], [\"slot\", \"icon-only\", \"name\", \"close\"], [4, \"ngFor\", \"ngForOf\"], [\"placeholder\", \"D\\u00E9tails de la consultation\", 3, \"ngModel\", \"ngModelChange\"]],\n  template: function ConsultationsModalComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-title\");\n      i0.ɵɵtext(3, \"Consultations\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"ion-buttons\", 0)(5, \"ion-button\", 1);\n      i0.ɵɵlistener(\"click\", function ConsultationsModalComponent_Template_ion_button_click_5_listener() {\n        return ctx.closeModal();\n      });\n      i0.ɵɵelement(6, \"ion-icon\", 2);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(7, \"ion-content\")(8, \"ion-list\");\n      i0.ɵɵtemplate(9, ConsultationsModalComponent_ion_item_9_Template, 5, 4, \"ion-item\", 3);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngForOf\", ctx.consultations);\n    }\n  },\n  dependencies: [i3.NgForOf, i4.NgControlStatus, i4.NgModel, i2.IonButton, i2.IonButtons, i2.IonContent, i2.IonHeader, i2.IonIcon, i2.IonItem, i2.IonLabel, i2.IonList, i2.IonTextarea, i2.IonTitle, i2.IonToolbar, i2.TextValueAccessor, i3.DatePipe],\n  styles: [\"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});\nexport class ConsultationsModalModule {}\n_ConsultationsModalModule = ConsultationsModalModule;\n_ConsultationsModalModule.ɵfac = function ConsultationsModalModule_Factory(t) {\n  return new (t || _ConsultationsModalModule)();\n};\n_ConsultationsModalModule.ɵmod = /*@__PURE__*/i0.ɵɵdefineNgModule({\n  type: _ConsultationsModalModule\n});\n_ConsultationsModalModule.ɵinj = /*@__PURE__*/i0.ɵɵdefineInjector({\n  providers: [AngularFirestore],\n  imports: [CommonModule, FormsModule, IonicModule]\n});\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && i0.ɵɵsetNgModuleScope(ConsultationsModalModule, {\n    declarations: [ConsultationsModalComponent],\n    imports: [CommonModule, FormsModule, IonicModule]\n  });\n})();","map":{"version":3,"names":["CommonModule","AngularFirestore","FormsModule","IonicModule","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","ConsultationsModalComponent_ion_item_9_Template_ion_textarea_ngModelChange_4_listener","$event","restoredCtx","ɵɵrestoreView","_r3","consultation_r1","$implicit","ɵɵresetView","details","ɵɵadvance","ɵɵtextInterpolate1","ɵɵpipeBind1","date","ɵɵproperty","ConsultationsModalComponent","constructor","firestore","modalController","newConsultation","Date","consultations","ngOnInit","loadConsultations","_this","_asyncToGenerator","consultationsSnapshot","collection","doc","patientData","medecinuid","nom","get","toPromise","docs","map","data","console","log","error","addConsultation","_this2","add","push","closeModal","dismiss","ɵɵdirectiveInject","i1","i2","ModalController","selectors","inputs","decls","vars","consts","template","ConsultationsModalComponent_Template","rf","ctx","ConsultationsModalComponent_Template_ion_button_click_5_listener","ɵɵelement","ɵɵtemplate","ConsultationsModalComponent_ion_item_9_Template","ConsultationsModalModule","imports","declarations"],"sources":["C:\\Users\\MacBook Air\\Desktop\\shifai1VV\\src\\app\\patients\\consultations-modal\\consultations-modal.component.ts","C:\\Users\\MacBook Air\\Desktop\\shifai1VV\\src\\app\\patients\\consultations-modal\\consultations-modal.component.html"],"sourcesContent":["import { CommonModule } from '@angular/common';\nimport { Component, Input, NgModule, OnInit } from '@angular/core';\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule, ModalController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-consultations-modal',\n  templateUrl: './consultations-modal.component.html',\n  styleUrls: ['./consultations-modal.component.scss'],\n})\nexport class ConsultationsModalComponent implements OnInit {\n  @Input() patientData: any; // Input pour recevoir les données du patient\n\n  newConsultation: { date: Date, details: string } = { date: new Date(), details: '' };\n  consultations: { date: Date, details: string }[] = [];\n\n  constructor(private firestore: AngularFirestore, private modalController: ModalController) {}\n\n  ngOnInit() {\n    // Chargez les consultations existantes du patient ici\n    this.loadConsultations();\n  }\n\n  async loadConsultations() {\n    try {\n      const consultationsSnapshot = await this.firestore\n        .collection('medecin')\n        .doc(this.patientData.medecinuid)\n        .collection('patients')\n        .doc(this.patientData.nom)\n        .collection('consultations')\n        .get()\n        .toPromise();\n  \n      if (consultationsSnapshot) {\n        this.consultations = consultationsSnapshot.docs.map((doc) => doc.data() as { date: Date, details: string });\n      } else {\n        console.log('Aucune consultation trouvée pour ce patient.');\n      }\n    } catch (error) {\n      console.error('Erreur lors du chargement des consultations du patient :', error);\n    }\n  }\n  \n  async addConsultation() {\n    try {\n      // Ajoutez la nouvelle consultation à Firestore\n      await this.firestore\n        .collection('medecin')\n        .doc(this.patientData.medecinuid)\n        .collection('patients')\n        .doc(this.patientData.nom)\n        .collection('consultations')\n        .add(this.newConsultation);\n\n      // Ajoutez également la nouvelle consultation à la liste locale des consultations\n      this.consultations.push({ ...this.newConsultation });\n\n      // Réinitialisez les champs de la nouvelle consultation\n      this.newConsultation = { date: new Date(), details: '' };\n\n      console.log('Nouvelle consultation ajoutée avec succès.');\n    } catch (error) {\n      console.error('Erreur lors de l\\'ajout de la nouvelle consultation :', error);\n    }\n  }\n\n  closeModal() {\n    this.modalController.dismiss(); // Fermer le modal\n  }\n  \n}\n@NgModule({\n  declarations: [ConsultationsModalComponent],\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule\n  ],\n  providers: [AngularFirestore],\n})\nexport class ConsultationsModalModule {}\n","<ion-header>\n  <ion-toolbar>\n    <ion-title>Consultations</ion-title>\n    <ion-buttons slot=\"end\">\n      <ion-button (click)=\"closeModal()\">\n        <ion-icon slot=\"icon-only\" name=\"close\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <ion-list>\n    <ion-item *ngFor=\"let consultation of consultations\">\n      <ion-label>Date: {{ consultation.date | date }}</ion-label>\n      <ion-textarea [(ngModel)]=\"consultation.details\" placeholder=\"Détails de la consultation\"></ion-textarea>\n    </ion-item>\n  </ion-list>\n</ion-content>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}